\documentclass[12pt,a4paper]{book}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[english]{babel}
\usepackage[numbers]{natbib}
\usepackage{graphicx}
\usepackage{float}
\usepackage{url}


\begin{document}


\title{Uncovering the properties of triple junctions}
\author{Paul Twine}

\maketitle

\tableofcontents

\chapter{Introduction} \label{ch:Intro}

A fundamental question in material science is how to find relationships between the microstructure and the macroscopic properties of a material. Polycrystalline materials comprise of grains, grain boundaries and triple junctions and their properties are essential to understanding the microstructure. The grain boundary is a two dimensional interface between two misorientated grains. A junction line occurs where three or more grain boundaries meet. The most common junction line is a triple line which has three adjacent grains and is where three grain boundaries meet. 

This paper will focus on triple line junctions although other higher order stable junction types do exist. The penta-twin is an example of a metastable higher order junction which generally exists in a nano-crystalline material and has been investigated in detail by \cite{Thomas2016}. A quad line is also investigated analytically in this section. The motivation for this was to present a physically plausbile mechanism for junction formation and to use this as a basis for calculating the formation energy of a quad line. The analogous approach is then used to calculate the formation energy of a triple line in Section \ref{sec:SimulationResults}. 

Grain boundaries always have a positive excess energy compared to a pristine crystal at zero kelvin. In general the excess energy of a planar grain boundary depends upon the relative misorientation between the two adjacent crystals and also the normal direction of the planer grain boundary. The macroscopic relationship between two planar grain boundaries can be described by five degrees of freedom. 

The five degrees of freedom can be clearly demonstrated by considering the relative orientations of the two crystals and the normal direction of adjoining planar grain boundary. Firstly the misorientation between two crystals can be defined by an axis of rotation and an angle of rotation about that axis.  The axis only defines a direction and can be completely specified by two degrees of freedom. A third degree of freedom is then the angle of rotation about that axis. Finally the grain boundary itself is a plane which can be defined by a normal unit vector which requires a further two degrees of freedom.

For non-planar grain boundaries curvature also generally increases the excess energy \cite{Mason2015}. Grain growth and evolution of grain boundaries using a curvature model seek to minimise the local curvature.  The excess energy in a grain boundary is generally much lower if the two lattices of the neighbouring grains form a coincident site lattice. As some atoms within the grain boundary retain some of their atomic bonding they have a lower overall potential energy due to a higher cohesive energy \cite{Rohrer2011}. Whilst grains and grain boundaries have been studied extensively \citeauthor{Chaix:149279} note that there has been relatively little work on triple lines as an entity in its own right \cite{Chaix:149279}.

A general method already exists for finding the excess energy associated with a planar grain boundary of a bicrystal. Firstly the potential energy of a single crystal with a fixed number of atoms is calculated. Then this crystal is bisected and the orientation of one half is changed so that there exists a crystallographic misorientation and a planar interface between the two halves of the crystal. The difference in the energy between the bisected crystal and the original single crystal can then be taken to be the excess energy of the grain boundary.

The formation energy of a triple line is more complicated as its existence necessary requires three grain boundaries and three grains. However a simple scenario involving a quad line can provide some phyiscial intuition and a possible approach to find the formation energy of a quad line. Figure \ref{fig:Quad} shows the analogous situation to the excess energy grain boundary derivation using two different configurations. This is a plan view of initial configuration of three grains separated by three grain boundaries. The grains are labelled $1, 2$ and $3$ and the grain boundaries are coloured red, green and blue. This is a periodic cell which is repeated in the vertical and horizonal directions. Each grain is also extruded out of the page and so the system is pseudo two dimensional.
\newpage
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/QuadConfigurations.png} 
\label{fig:Quad}
\caption{Two periodic cells showing a simplified formation process of a quad line.}
\end{figure}
 
In the periodic cell on the left there already exists one periodically unique triple line which is formed at the four corners of the rectangle. The grain boundaries shown in blue and green do not intersect near the middle of the cell. The initial configuration is then a set of three grains, three grain boundaries and a single triple line.

The periodic cell shown on the right is a modification of the cell on the left and contains an indentical number of atoms. The only change is that grain boundary in blue has moved upwards so that the green and blue boundaries intersect. This now a system of three grains and four grain boundaries as the blue grain boundary has now been bisected. This forms a new quadline which is shown in yellow.

The movement of the blue grain boundary does not affect its normal  or the orientations of grains $B$ and $C$ and so it is assumed that the interfacial energy of the blue grain boundary does not change significantly. There is also an implicit assumption that the shape of the grain boundaries do not distort as a result of forming the quad line. A lower bound for the formation energy of a quad line can now be estimated by considering the blue, red, green and yellow regions of defective atoms.

The intersecting region of the blue and green grain boundaries is shown in yellow. The total number of atoms is fixed and this overlapping region reduces the number of defective of atoms in the grain boundaries. Therefore it also increases the number of lattice atoms in the bulk. Provided that the energy increase in the yellow region is less than the enery reduction due to the atoms migrating from the grain boundary to the lattice the triple line will have a negative formation energy. 
 
The lower bound for energy of formation of the quad line can be estimated by comparing the two periodic cells. Firstly using a mass balance gives the following equation

\[ n_1 + n_2 + n_3 + n_B + n_G + n_R = n_1^{\prime} + n_2^{\prime} + n_3^{\prime} + n_B^{\prime} + n_G^{\prime} + n_R^{\prime} +
n_Y^{\prime} \]

where $n_i$ is the number of atoms in lattice $i$ and $n_B, n_G$ and $n_R$ are the number of atoms in the blue, green and red grain boundaries respectively. The $\prime$ indicates the values for the right hand periodic cell after the blue grain boundary has moved.  The number of atoms in the intersecting yellow region is given by $n_Y^{\prime}$.

The equation can be simplified by assuming that $n_G^{\prime} = n_G-n_Y^{\prime}$, $n_B^{\prime} = n_B-n_Y^{\prime}$ and $n_R^{\prime} = n_R$. 

\[ n_1 + n_2 + n_3   = n_1^{\prime} + n_2^{\prime} + n_3^{\prime}- n_Y^{\prime} \]

A key result here is that the the final number of lattice atoms is larger by an amount $n_Y^{\prime}$ than the inital number of lattice atoms. The difference in energy between the two periodic cells gives an lower bound estimate of the formation energy $E_f$ of the quad line.

\begin{align*}
 E_{fl} &= U_L(n_1+n_2+n_3+n_Y^{\prime}) + U_G(n_G - n_Y^{\prime})
+ U_B(n_B - n_Y^{\prime}) \\ 
&+ U_R n_R + U_Q n_Y^{\prime}
- U_L(n_1+n_2+n_3) - U_G n_G - U_B n_B - U_R n_R  
\\ 
&=  n_Y^{\prime}(U_L - U_G - U_B + U_Q) = n_Y^{\prime}((U_L - U_G) - (U_B - U_Q)) 
\end{align*}

where $U_L, U_G$, $U_B$ and $U_Q$ are the mean potential energies per atom in the lattice, green grain boundary, blue grain boundary
and quad line respectively. Defining $U_M = (U_B + U_G)/2$ as the mean grain boundary energy per atom averaged over the blue and green grain boundaries then

\[E_{fl} =  n_Y^{\prime}(U_L + U_Q - 2U_M)\]

The lower bound for the formation energy taken in isolation might suggests that a quad line would tend to be more stable than a triple line. The stability of the system must take into account all its components and in fact there is a driving force for quad lines to split into two triple junctions as argued by \citeauthor{Lazar2011} in \cite{Lazar2011} and \citeauthor{Kinderlehrer2006} in \cite{Kinderlehrer2006}. The total energy of the system depends upon the excess energy contribution from the grain boundaries as well as any energy change in forming a quadline.


An upper bound for the energy of formation of the quad line can also be estimated by considering a slight modification to the above argument. If it is assumed that the total number of defective atoms remains constant and hence so does the number of lattice atoms then the energy of formation of the quad line can
be written as

\[E_{fu} =  n_Y^{\prime}(U_Q - U_M) = E_{fl} + n_Y^{\prime}(U_M - U_L) > E_{fl} \]

The majority of quad junctions are actually unstable and split into two triple junctions reducing the total grain boundary length \cite{Lazar2011,Kinderlehrer2006}. This process would generally reduce the total energy of the system provided the difference in formation energies of the quad lines and triple lines was sufficiently small. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=1]{images/QuadToTriple.png} 
	\label{fig:QuadToTriple}
	\caption{Quad line deforming into a pair of triple lines}
\end{figure}

Figure \ref{fig:QuadToTriple} shows a quad line with four equal length grain boundaries meeting at a central point each making an equilbrium angle of $90^{\circ}$. If the side length of the enclosing square is $l$ then the total grain boundary length is $2\sqrt{2}l$. The configuration where the quad line splits into two triple lines has a smaller total grain boundary length of $(1 + \sqrt{3})l < 2\sqrt{2}l$. The triple lines each form a new equilibrium angle of $120^{\circ}$. If the assumption is made that the total grain boundary length dominates the difference in energy between the two configurations then the two triple line configuration has lower energy than the quadline and is more stable. 

This paper will explore the potential energies and formation energies of 276 distinct triple lines focus using molecular dynmaics in LAMMPS. The energies of indiidual triple lines will be estimated using periodic hexagonal grain configuration shown in Figure \ref{fig:PerCell}. The boundaries of the simulation cell are shown as a black parallelogram. The grains are extruded in the direction perpendicular to this parallelogram making the geometry of the system quasi two dimensional.

\begin{figure}[H]
	\includegraphics[scale=0.75]{images/GrainConfigurationPeriodic.png}
	\label{fig:PerCell} 
	\caption{Plan view of the periodic cell configuration. The boundaries of the simulation cell are shown as a black parallelogram.}
\end{figure}

The study will be restricted to pure Alumininum in a solid state using an emperical embedded atom potential given in \cite{Zope2003}. The results of the simulations are processed to detect the location of triple lines and grain boundaries using image analysis techniques in Python. The potential energy of grain boundaries triple lines is then estimated using the emperical potential. The atomic density and potential energies and to find an upper and lower bound for the triple line formation energies. The paper is structured as follows: There is a review of the current research in Chaper \ref{ch:lr}. Chapter 2 then discusses the simulation approach using molecular dynamics and the processing of the resulting data.   


\chapter{Literature Review} \label{ch:lr}

 
Triple lines have been investigated as purely mathematical objects and a good summary of the key points can be found in \cite{Taylor1999}. The discussion includes scenarios where the triple line can have positive and negative formation energies. A key feature here is whether a triple line is considered to be a purely geometric line or whether it has a non-zero volume and consists of atoms. Taylor discusses different scenarios and specifically addresses potential issues with negative triple lines. Taylor argues that extra cylindrical sections of grain boundary could be added to a planar grain boundary so that the axis of symmetry is perpendicular to the grain boundary normal. In this way extra triple lines could be added and if they had a negative excess energy then the energy of the system could be made increasingly more negative. However such a process necessarily also required extra grain boundary to be created which has a positive excess energy and so this process does not seem physically plausible when viewed from an atomistic perspective.

A key feature of triples lines is described by the Herring relationship. The dihedral angles between three planar grain boundaries that meet at a triple line are optimised using an energy minimisation. The analysis focusses on a small region surrounding the triple line and is a first order approximation. As such the curvature of the grain boundaries is ignored and the triple line itself has zero volume. 

The Herring relationship can be understood as minimising the energy in creating the three planar grain boundary interfaces. The expression is essentially a force balance where the force is an energy gradient associated with \emph{creating} the interface. This is often described as a line tension associated with the grain boundary but does not refer to any type of elastic deformation of the lattice. It also noted by \citeauthor{CRAIGCARTER} that the as the forces are usually resolved in the plane perpendicular to the triple line so it cannot include any contribution from the triple line \cite{CRAIGCARTER}. 
     
\[\gamma_{A/B}\mathbf{\hat{t}}_{A/B} + \gamma_{B/C}\mathbf{\hat{t}}_{B/C} + \gamma_{A/C}\mathbf{\hat{t}}_{A/C} =\mathbf{0} \]

Here the term $\gamma_{A/B}$ is the excess interfacial energy of the grain boundary between grains $A$ and $B$ and $\mathbf{\hat{t}}_{A/B}$ is the unit tangent vector of the same grain boundary. The Herring relationship only requires the relative measures of the interfacial energy of each grain boundary to be balanced.

The Herring relationship can be extended further by considering the rotation of the grain boundary interfaces about the triple line. This gives the ``torque'' term of the energy balance and which act parallel to the grain boundary normal respectively. Simplifications often neglect this term even though the grain boundary normal direction can have a large effect on the excess interfacial energy of the grain boundary \cite{Rowenhurst}.

There is currently no universally agreed method to define the excess energy associated with a triple line. Atomistic simulations undertaken by Adlakha used the summation of atomic data with a 19 nm radius of the triple line and compared this to a pristine lattice at 0 k \cite{Adlakha2015}. The individual grain boundary energies were calculated separately and then the three grain boundaries were made to meet at the triple line. The grain configuration is not periodic and there was no indication of the possible effect of free surfaces. The calculations appear to have taken place at zero Kelvin using energy minimisation techniques. 

The energy content of triple lines has been investigated by Srinivasan et al in \cite{Srinivasan1999} using atomistic simulation. Here there is an interesting discussion of the apparent paradox of the high potential energy expected in a triple line and a possible negative formation energy. The results in Section \ref{sec:SimulationResults} indicate that it is possible to define a triple line volume to have a positive excess potential energy and also a negative formation energy. 

The approach adopted in \cite{Srinivasan1999}   
produced statistical averages for the potential energies of the triple lines and grain boundaries. An inherent difficulty with this approach is the periodic variation of potential energy along the grain boundaries produces a lot of statistical noise which affects the accuracy of the results. By contrast the method proposed in Section \ref{sec:TJLocation} of this paper is to calculate approximate values for indiviudal triple lines and also define a cylindrical volume associated with the triple line that excludes the grain boundaries.

Srinivasan also mentions that the triple line can be described using eleven degrees of freedom assuming it can be approximated by the intersection of three planar grain boundaries. By assigning a coordinate system to be aligned with one of the three grains there are three degrees of freedom for each of the other two grains which can be orientated independently of each other. Two of the grain boundaries can then be orientated independently of each other giving a further two degrees of freedom each. However these two grain boundaries will in general intersect along a line if the pathological cases of identical grain boundary planes and parallel grain boundary planes are excluded. Therefore the final grain boundary has only one degree of freedom which can be interpreted as an angle of rotation of the grain boundary around the triple line.

The eleven degrees of freedom of a triple line are a result of applying a constraint to the geometry and in general three arbitrary planes cannot be made to intersect along a single line.  In real materials grain boundaries are curved and each grain boundary and triple line has a non-zero volume. Clearly triple lines can contribute vastly to the possible parameter space for a given simulation and only a small subset of all the possible parameters can be considered.

The results of the research in \cite{Srinivasan1999} appeared to showed a negative excess energy associated with the triple line. However the approach computed a mean average of several triple lines and this does not guarantee that every triple line in the simulation cell has a negative excess energy.The work also only considered a few specific grain configurations with relatively simple misorientation angles. This paper will extend this approach by considered a wider set of grain configurations and also seek to compute the energies of individual triple lines.

Two dimensional triple junctions in graphene were  investigated in \citep{Hirvonen2017} and showed that some triple lines had negative formation energies. The paper acknowledges this result was somewhat controversial and also refers to several papers which found positive formation energies fo copper and negative for iron. The analysis is limited to highly symmetric grain configurations and there is an implicit assumption that all the triple line energies in each scenario were equal.

A negative formation energy could suggest that there is a driving force for triple line creation. Theoretically a triple line could decompose into three new triple lines if this achieved a reduction in the total energy. This would depend upon the energy reduction due to the three new triple lines and the energy increase due to the creation of three new grain boundaries. However even if the triple line did decompose into three new triple lines \citeauthor{Shvindlerman2005} showed that in two dimensions triangular grains were always unstable and would disappear \cite{Shvindlerman2005}. It is currently unknown which process would dominate. 

Theoretical work by Gottstein et al in \cite{GOTTSTEIN2010914} looked at the effect that triple lines could have on the mobility of the adjacent grain boundaries. A key result from the paper suggests that there is a critical grain radius below which that the driving force due to the excess energy of the triple line is more significant than the driving force due to the excess energy from the grain boundaries. This is a substantial finding which demonstrates that in smaller grains the effect of the triple line cannot be ignored. 
 
Research by Gottstein et al \cite{GOTTSTEIN2010914} showed that the dihedral angles formed between the grain boundary planes are affected by the mobility of the triple line and this is not taken into account by the Herring relationship. The triple line mobility can cause a drag on grain boundary motion and so influences the geometry of the grain boundaries near the triple line. Brechett suggests that triple lines would respond differently to Zener pinning than their neighbouring grain boundaries. The Zener pinning at the triple line is expected to have a larger effect than pinning at the grain boundary. \cite{BRECHET2010910}.

The Neumann von Mullins relationship is a key theory of grain evolution and describes how grain growth can be modelled based upon grain boundary curvature \cite{Lazar2011}. Grains grow and grain boundaries evolve based upon minimising their local curvature. The Neumann con Mullins relationship assumes that the triple lines have no effect on grain growth as shown by Gottstein in \cite{GOTTSTEIN2010914}. However for small grain sizes once the drag effect due to triple lines is taken into account Gottstein showed a significant decrease in the rate of grain growth.

A substantial amount of research suggests that triple lines in nano polycrystalline material may affect how grain boundaries deform as this depends upon the mobility of the triple line \cite{BRECHET2010910,Shvindlerman2005, Fischer2012,
GOTTSTEIN2000, ZOLLNER201241, Miessen2015, Thomas2019}. The stability of polycrystalline structure depends upon the potential energy associated with each region within the grain. The creation of an interface between the two grains has an corresponding excess energy compared to the pristine lattice at zero kelvin. However the energy associated with a triple line remains an open question which is investigated in this paper.

Greer suggests that triple lines are favourable sites for nucleation in crystalline materials but their line tension is rarely considered when analysing the energies   \cite{GREER2010899}. \citeauthor{King2010} also argues that triple lines could be favourable sites for nucleation and may be   regions where rapid diffusions occur \cite{King2010}. Triple lines can also be sites for dislocation pile up and this is an important mechanism in creating non-equilbrium grain boundary structures \cite{Nazarov1993}. 

As the scope of the paper is restricted to pure metals in the solid phase the embedded atom method has been chosen as the theoretical basis of the emperical potentials. The embedded atom method is considered to be superior to a simple pair wise potential especially when simulating defects and a full review of the method is give in \cite{Daw1993}. As the main focus is the behaviour of triples lines and their neighbouring grain boundaries it is particularly important that the emperical potential can model defects accurately . 



\chapter{Molecular Dynamics}

The triple line configurations are investigated using molecular dynamics simulation in LAMMPS. The periodic hexagonal configuration in Figure \ref{fig:PerCell} is constructed for a variety of misorientation angles which affect the excess interfacial energy at each grain boundary. The potential energy of grain boundaries and triple lines are estimated using an emperical potential by associating regions inside the simulation cell with the triple lines and grain boundaries. 

The geometry of the simulation cell is described using three cartesian vectors $\mathbf{i}, \mathbf{j}$ and $\mathbf{k}$. The vector $\mathbf{i}$ points right along the page and $\mathbf{j}$  points up the page. The vector $\mathbf{k}$ points out of the page. The crystallographic directions of the lattices which are described using Miller notation.

\begin{figure}
	\includegraphics[scale=0.75]{images/GrainConfigurationNumbers.png}
	\caption{Plan view of the simulation cell with the periodically equivalent grains numbered.}
	\label{fig:PerCellNumbers} 
\end{figure}

The simulations cell is periodic and a plan view of the repeating hexagonal grid is shown in Figure $\ref{fig:PerCellNumbers}$. The atoms are colour according to the polyhedral template matching described in \cite{Larsen_2016} and the algorithm  was implemented in Ovito \cite{Stukowski2009}. Atoms shown in green are identified as having an FCC structure based upon a root mean square deviation (RMSD) from an ideal FCC template. 

All the simulations in this paper have used an RMSD value of $0.05$ which is lower than widely used value of $0.1$. This will tend to categorise more atoms as not belonging to a standard crystallographic strucure and hence there will be a relatively large number of white atoms. Atoms that are matched as an FCC structure will be referred to as polyhedral template matched atoms and abbreviated as PTM atoms. Any atom that isn't identified as an FCC atom will be a non-PTM atom. The non-PTM atoms include any atoms that have been identified as a non-FCC crystallographic structure by the polyhedral template matching algorithm. For example some grain configurations produced stacking faults and as a result atoms in the grain boundaries are identified as having a HCP structure. These HCP atoms are still considered to be non-PTM atoms.
 
All the grain boundaries are tilts boundaries as the rotation axis is parallel to the simulation cell $\mathbf{k}$ vector which points vertically upwards and hence perpendicular to the normal vector of the vertical planar grain boundaries. The lattice within each grain is rotated so that there is a misorientation between the grains. As it is only the relative misorientation that matters only two grains need to be rotated. The two rotation angles must not be equivalent once the symmetries of the lattices have been considered. 

Although there are only three grains this produces six periodically distinct triple lines and nine periodically distinct grain boundaries. The grain boundary plane as well as the misorientation between the adjacent grains both contribute to the excess interfacial energy of the grain boundary and so in general each grain boundary will have a different excess energy. In fact atomistic simulations by \cite{HOLM2010905} showed a relatively large variation in grain boundary energies for Al which was largely attributed to a high stacking fault energy. 

The simulation in LAMMPS begins with the conjugate gradient energy minimisation to relax the initial grain structure. This is followed by a $300$ Kelvin thermal annealing using a canonical ensemble. This ensures that the number of particles, the volume of the simulation cell and the temperature are all conserved. After a short annealing there is a second energy minimisation using the conjugate gradient approach. At $300$ Kelvin there was still a small amount of melting shown by some non-PTM atoms appearing in the bulk. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=1]{images/CellWithMelting.png} 
	\label{fig:CellMelt}
	\caption{Simulation cell with some melting in the bulk shown
	as isolated white dots}
\end{figure}

It is also apparent that even with a very low choice of RMSD as $0.05$ the non-PTM atoms do not from continuously connected grain boundaries between the triple lines.

The simulation cell dimensions were chosen so the the cell was extended to approximatly $80 \AA$ in the $\mathbf{k}$ direction as the feature of interest was behaviour near the triple line. This value changed slightly due to different crystallographic directions were oriented parallel to the $\mathbf{k}$ direction. Similarly the number of atoms involved in each simulation was approximately 250,000.  


\section{Triple line Detection}

The constituent parts of a simulation cell comprise of the grains, grain boundaries and triple lines. The use of an emperical potential allows for different regions of space to be assigned a proportion of the simulation cell's potential energy. In order to do this an algorithm is required to identify regions that correspond to grain boundaries, triple lines and grain atoms.

As an initial first step the polyhedral template matching alogrithm (PTM) is used to make a binary choice as to whether an atom is a PTM or non-PTM atom. The atoms are matched to an FCC structure with a lattice parameter of $a=4.05$. If an atom is indentified as belonging to a different crystallographic structure then this is also designated as a non-PTM atom. The majority of the PTM atoms will reside in the bulk and similarly the majority of non-PTM atoms will be considered grain boundary or triple line atoms. 

It is important to emphasise that PTM atoms \emph{do not} define whether an atom is part of a grain or in the grain boundary. In fact it is desirable to define grain boundaries with different widths as discussed in Section \ref{sec:SimulationResults} here. The PTM atoms are only used as a starting point for defining triple line positions and grain boundaries.

The process of triple line detection uses an image analysis technique based upon the positions of the non-PTM atoms. The process begins by projecting all the non-PTM atoms onto the $xy$ plane of the simulation cell. The $xy$ plane is then partioned into a grid consisting of parallelograms. The side lengths of each parallelograms are chosen to be equal to the lattice parameter. Each paralleogram is then shaded if there are more than a specified number of non-PTM atoms whose projected co-ordinates lie inside the parallelogram. This minimum number is a parameter that depends upon the height of the simulation cell and the density of the non-PTM atoms.

The shading of the parallelograms is to give an indication of where the grain boundaries lies and their intersections will also give the approximate position of the triple lines. The base of the simulation cell is a parallelogram however it is easier to deal with the periodicity of the simulation cell by transforming the points into a rectangular parameter space using a shear transformation. 

In order to achieve a continuous shape several image processing techniques are used. Firstly the small holes within the image are filled with a default setting of an area of less than or equal to four pixels. Then the image is also dilated so that each yellow point also has its neighbouring points within a fixed distance coloured yellow. This has the effect of filling in and broading the pixelated represention of the grain boundaries and is shown in the first diagram on the left of Figure $\ref{fig:ImSt}$. 

The value chosen for the dilation is a compromise between ensuring any gaps in a grain boundary are removed and trying to retain as much of the detail as possbible in the grain boundary shapes and positions. Small objects with an area of four pixels or less are also removed. This is to remove small groups of defective atoms that may appear in the bulk but are not part of a grain boundary or triple line. At this stage the edges of the yellow shaded regions are not generally smooth.

 
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.4]{images/ImageSteps.png} 
	\caption{Diagram showing three steps of the image analysis. The left image is a shear transformation of the original atomic positions. The middle image has been extended periodically and then smoothed using a Gaussian filter. The image on the right is a skeletonized transformation of the middle image.}  
	\label{fig:ImSt}
\end{figure}


The periodicity in the plane of the base of the simulation cell is included by extending the image array periodically. The dimensions of the image arrays in the middle and on the right of Figure \ref{fig:ImSt} are larger due to this periodic extension. Each triple line that was originally very near the boundary of the image array now lies inside the extended image array and so can also be detected. The yellow pixels have also been smoothed using a Gaussian filter to avoid erroenous triple points being created when the image is skeletonized using a process outlined in \cite{ZHANG1997}. The results are shown in the middle diagram of Figure $\ref{fig:ImSt}$.  

Finally the image is then reduced to a skeleton of points. The skeleton preserves the same connectivity of the original image but reduces the image to a series of lines each with a width of one pixel. The skeleton image is then used to detect triple lines and also form an adjacency matrix for the triple lines. The third image on the right of Figure $\ref{fig:ImSt}$ shows the skeleton image and the triple lines are now yellow dots. The grain boundaries and grain boundary fragments are now approximated by the light blue lines.

The diagram on the right of Figure $\ref{fig:ImSt}$ also includes green dots  where a grain boundary appears to terminate in the bulk. These points are \emph{not} triple lines and a blue line connecting a yellow triple line to a green dot is \emph{not} considered a grain boundary. In fact these are periodic repeats of part of an grain boundary that has already been included inside the periodic cell and is discarded from the remaining analysis.
 
Periodically equivalent triple lines are identified using the perioidic vectors in the rectangular parameter space. In addition to triple line equivalency the rectangular parameter space also identifies all the adjacent triple lines to each triple line. 
The approximate position of the triple line in the original simulation cell can now be found by reversing the linear transformation that produced the rectangular parameter space.

This grain boundaries can then be represented by considering pairs of adjacent triple lines. Each grain boundary is defined using a basis spline whose start and end point are a pair of adjacent triple lines. The basis spline is a curve which is fitted through the non-PTM atoms that connect the two adjacent triple lines. This allows for accurate representation of curved grain boundaries which is vital to make the potential energy calculations as accurate as possible. As part of the analysis in Section \ref{sec:SimulationResults} the potential energy of the triple line will be compared to the potential energies of the three adjacent grain boundaries.  


\section{Tripleline Location} \label{sec:TJLocation}

The position of the tripleline is further refined by considering a cylindrical volume whose axis is parallel to the simulation cell $\mathbf{k}$ vector going through the first estimate of the tripleline location given by the image analysis of the previous section. The non-PTM atoms positions that lie inside the small cylinder of radius are projected onto the base of the simulation cell. The mediod of these points is then used as a refined estimate of the triple line position. The medioid is preferred to a simple mean of the atomic positions as this prevents the tripleline being positioned within the PTM atoms which are predominantly lie inside the lattice. A full description of the medioid and its implementation in Python is given in \cite{Bauckhage2015}. 



\section{Statistical Analysis of Potential Energy}


Ideally the excess potential energy of the triple line should be decoupled from the the excess potential energies of the neighbourning grain boundaries. To minimise the effect of the grain boundaries three thin cuboid strips of atoms are selected from the triple line. An example of the selected atoms is shown in Figure \ref{fig:StarAtoms}. Each strip goes out from the triple line bisecting the two neighbouring grain boundaries. A plan view of the grain boundaries, triple lines and selected region is shown in Figure \ref{fig:GBsandStar}. Each periodically unique triple junction is labelled $UTJi$ where $i$ is in an integer from 0 to 5. Each grain boundary is labelled using the two triple junctions labels that lie at each end of the grain boundary.

The radius of the cylindrical region of atoms that define the triple line can now be calculated by using the black selected region of atoms shown in Figure \ref{fig:GBsandStar}. Along each cuboid strip the potential energy per atom decreases and approaches the potential energy per atom of the lattice as the radial distance from the triple line increases. The critical radial distance is defined to be when the relative difference  between the sampled potential energy per atom in a small subset of the cuboid strip and the lattice potential energy per atom is less than $0.01$. The lattice potential energy was estimated by taking the mean potential energy per atom over a cylindrical volume of the PTM atoms centred at the triple line. The radius was taken to be half the distance from this triple line to the closest triple line. In general this estimate of the lattice potential per atom was slightly higher than the theoretical value given in \cite{Zope2003}.

There are three critical distances from the triple line each associated to one of the three cuboid directions shown in Figure \ref{fig:StarAtoms}. The triple line is then repositioned at the point equidistance from the three critical distances. The critical radius is then radial distance from this new triple line position to any of the three critical points.       

The potential energy of the triple line could then be found directly by counting all the individual potential energies of the atoms enclosed inside the cylinder with the critical radius found in the previous paragraph. However even with a simulation cell that is very extended in the $\mathbf{k}$ direction this direct method is very sensitive to small changes in triple line position and radius.

Instead the potential energy is approximated by a continuous function which finds the accumulative potential energy per atom inside all three cuboid strips as function of the radial distance from the triple line. The data collected in the three cuboid strips is fitted using a reciprocal function starting from the critical radius and extending into the lattice. The maximum distance for each cuboid strip is defined to be half the distance from the triple line to the next closest triple line.


An idealised theoretical approach using a three grain strips of negligible width from the triple line is shown below 

\[ U_V(L) =\frac{1}{3 L h}\int_{l=0}^{r=L} h \delta(l) U_{TJ/L} + 3(1-\delta(l) ) h U_{L/V}  \text{d}l = \frac{U_{TJ/L}}{3L}  + U_{L/V} 
\label{eq:L1}
\]
here $\delta(l)$ is the Dirac delta distribution.

The function $U_V(L)$ gives the total potential energy per volume for a radial distance $L$ from the triple line and the reciprocal relationship describes some useful features. The curve must asymptotically approach potential energy per volume of a region of pristine lattice as $L \rightarrow \infty$. Actual data from the simulation shows a strong reciprocal relationship except very near the triple line and the correct asymptotic behaviour for large values of $L$. 

The intercept  of the function $U_V(L)$ on the vertical axis is a free boundary condition. Although the total potential energy must shrink to zero as the volume of the cylindrical region shrinks to zero the energy per volume may approach a non-zero limit. The potential energy per atom is necessarily a discrete quantity and so the formal notion of a limit does not apply. 

In reality the three grain strips have a small constant width of $4.05 \AA$. The three directions help to mitigate any sensitivity due to small changes in the position of the triple line. However the summation of the individual atoms over the volume still shows some considerable fluctuations. This effect can be mitigated by averaging the potential energy per atom rather than per unit volume. Within the lattice the atomic density is almost constant and so this is linearly dependent upon the potential energy per unit volume.  


The potential energy per atom for a triple line is then estimated by using a reciprocal function fitted to the potential energy per atom data found in the three cuboid strips. The triple line radius is then used to calculate the potential energy per atom inside the cylindrical region. The contributions of the three cuboid strips was chosen to avoid grain boundaries and hence only calculate the excess energy due to the triple line.  

\begin{figure}
	\includegraphics[scale=0.75]{images/StarAtoms.png} 
	\label{fig:StarAtoms}
	\caption{Three cuboid strips from the triple line into the
	neighbouring grains.}
\end{figure}


\begin{figure}
	\includegraphics[scale=0.75]{images/GBsAnd3Stars.png} 
	\label{fig:GBsandStar}
	\caption{Nine grain boundaries shown in different colours and a selected region of atoms shown as a three pointed star with periodically unique triple junction UTJ3 at its centre.}
	   
\end{figure}


\chapter{Simulation Results} \label{sec:SimulationResults}

The periodic hexagonal configuration of grains was tested using a variety of misorientation angles between the grains.  The simulations form three distinct groups based upon each grain in the group having a common lattice direction parallel to the simulation cell $\mathbf{k}$ vector. The three groups had either a common $[0 0 1]$, $[1 1 0]$ or $[1 1 1]$ parallel to the simulation cell $\mathbf{k}$ vector. The lattices of a particular group shared the same rotational symmetries about the simulation cell $\mathbf{k}$ vector depending upon the common lattice direction.

When the $[0 0 1]$ direction of the lattices is parallel to $\mathbf{k}$ the lattices have rotational symmetry of order 4 about $\mathbf{k}$.  Different angles of rotation about $\mathbf{k}$ to produce grain boundaries with different interfacial energies. One grain was not rotated and the other two grains were rotated by angles that were distinct modulo $90$. The simulation uses of rotation angles of $15^{\circ},30^{\circ},45^{\circ},60^{\circ}$ and $75^{\circ}$ and since no two grains can be rotated by the same angle this gives 20 different configurations.

For the $[1 1 0]$ direction the lattices have rotation symmetry of order 2. Applying the same approach as the previous paragraph using angle increments of $15^{\circ}$ would produce 110 distinct configurations. However the parameter space can be reduced by assuming that the interfacial energy of a grain boundary is unchanged if one of the lattice orientations is reflected in the grain boundary plane. In this way the effective rotational symmetry is now order 4 as with the $[0 0 1]$ direction and there are again 20 distinct configurations.  

Finally the $[1 1 1]$ direction has rotational symmetry of order 6. The angles used are therefore $15^{\circ},30^{\circ}$  and $45^{\circ}$ giving only 6 distinct configurations. In total the data consists of 46 different simulations producing 276 distinct triple lines and 414 grain boundaries. The results are presented in the next section as normalised histograms and where possible they were approximated with continuous probability distributions.  

\section{Triple line Accuracy}

In general the triple line detection method appeared to be accurate and the predicted radii seemed plausible. Figures  
\ref{fig:GoodTJFit} and \ref{fig:GreatTJFit} show typical placements of the triple line.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/GoodTJFit.png} 
	\label{fig:TJGoodFit}
	\caption{Plan view of a cylindrical region containing PTM atoms shown in green, non-PTM atoms shown in grey and the tripleline shown in red.}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/GreatFitTJ.png} 
	\label{fig:GreatTJFit}
	\caption{Plan view of a cylindrical region containing PTM atoms shown in green, non-PTM atoms shown in grey and the tripleline shown in red.}
\end{figure}

The algorithm was still reasonable successful when there were unusual variations in the defects around the triple line. However the positioning of figures \ref{fig:WorstTJFit} and  \ref{fig:BadTJFit} are not as accurate. In particular Figure \ref{fig:WorstTJFit} produced the largest triple line radius which appears to be an possible outlier.  

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/WorstTJFit.png} 
	\label{fig:WorstTJFit}
	\caption{Plan view of a cylindrical region containing PTM atoms shown in green, non-PTM atoms shown in grey and the tripleline shown in red.}
\end{figure}


\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/BadTJFit.png} 
	\label{fig:BadTJFit}
	\caption{Plan view of a cylindrical region containing PTM atoms shown in green, non-PTM atoms shown in grey and the tripleline shown in red.}
\end{figure}

\newpage
\section{Triple Line Dimensions}

Figure \ref{fig:TJRadii} shows a histrogram of the distribution of all 276 triple line radii detected using the method described in Section \ref{sec:TJLocation}. The largest radius which corresponds to Figure \ref{fig:WorstTJFit} is clearly visible on the far right. The distribution shows postive skew with a clear peak at about $3.2 \AA$. All the triple lines are assumed to be cylindrical with length equal to the height of the simulation cell

\begin{figure}[H]
	\includegraphics[scale=0.75]{images/Triplelineradii.png}  
	\caption{Normalised histogram of 276 triple line radii in Anstroms.}	
	\label{fig:TJRadii}
\end{figure}	

The atomic densities of all 276 triple lines are shown in Figure \ref{fig:AtomicDensityVR} in the orange histogram. In the same figure is a blue histrogram showing the mean atomic density averaged over the three adjoining grain boundaries. The width of the adjoining grain boundaries is taken to be twice the radius of the triple line. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/AtomicDensityAllVR.png}
	\label{fig:AtomicDensityVR} 
	\caption{A comparison of the atomic density in triple lines of different radii shown in orange compared to the atomic density of the adjoining grain boundaries.}
\end{figure}

The Gaussians distribution of Figure \ref{fig:AtomicDensityVR}  showed that the triple lines had $\mu = 0.58 \AA, \sigma = 0.0065 \AA $ and a $95\%$ confidence interval of $[0.045, 0.070]$ Anstroms. The grain boundaries had $\mu = 0.60 \AA, \sigma = 0.0016 \AA $ and a $95\%$ confidence interval of $[0.056, 0.063]$ Anstroms. As a comparison the theoretical value for the atomic density within the lattice is
$0.060 \AA$. The triple lines had a lower mean atomic density but also a larger spread of values. At an atomic level a small width or radii can lead to a large scatter in the densities as discussed in \cite{Kamachali2019}.  
 



\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{images/AtomicDensityAllFR.png} 
	\label{fig:AtomicDensityFR}	
	\caption{A comparison of the atomic density in triple lines of constant radii shown in orange compared to the atomic density of the adjoining grain boundaries.}
\end{figure}

Figure \ref{fig:AtomicDensityFR} shows the results of an alternative approach to estimating the atomic density using a fixed radii of $4.05 \AA$. However this approach produced a trimodal distribution in the triple line radius histogram making it unsuitable to be modelled as a Gaussian distribution. A further investigation of this showed that peaks were only prominent in the data with the $[110]$ direction parallel to $\mathbf{k}$ and this is discussed further in section \ref{sec:FutureWork}. 



\newpage
\section{Triple Line Potential Energy}

The potential energy associated with the 276 triple lines investigated in this paper are analysed in this section. The parameters and confidence intervals are all given to two significant figures. The simulation cell was chosen with a height of approximately $80\AA$ as the region with a small radial distance from the triple line was of interest. 

The data collected from the simulations was processed in two different ways. The first method calculated the energies based upon the individual radii found for each triple line shown in Figure \ref{fig:TJRadii}. The second method used a constant fixed radius of $r = 4.05 \AA$ which is the lattice parameter for Al. 

The graph in Figure \ref{fig:ExcessPEVR} shows the excess potential energy in the triple line compared to the adjoining grain boundaries for triple lines of variable radii. The calculation found the potential energy per atom inside the triple line and then subtracted the potential energy per atom averaged over the three adjoing grain boundaries with a width of twice the triple line radius. 
 

\begin{figure}[H]
	\includegraphics[scale=0.75]{images/AxisAllExcessFit.png}
	\label{fig:ExcessPEVR}
	\caption{The excess potential energy per atom in the triple lines of variable radii above the potential energy per atom in the adjoining grain boundaries.} 
\end{figure}

The data was also fitted to a Gaussian distribution with $\mu = 0.022$ and $\sigma = 0.018$. A key features is that the majority of the triple lines had a positive excess energy per atom compared to their adjoining grain boundaries. A $95\%$ confidence interval for the excess potential energy per atom
$[-0.013, 0.057]$.

The corresponding graph for triple lines with a constant fixed radius of $4.05 \AA$ is shown in Figure \ref{fig:ExcessPEFR}

\begin{figure}[H]
	\includegraphics[scale=0.75]{images/AllExcessFitFR.png} 
	\label{fig:ExcessPEFR}
	\caption{The excess potential energy per atom in the triple lines of fixed radii above the potential energy per atom in the adjoining grain boundaries.}
\end{figure}

This data was also fitted to a Gaussian distribution with $\mu = 0.019$ and $\sigma = 0.016$. The majority of the triple lines had  a positive excess energy per atom compared to their adjoining grain boundaries although the mean was a little lower and the spread of data was smaller. There appears to be one outlier in the data. The $95\%$ confidence interval for the excess potential energy per atom was $[-0.013, 0.051]$.

The values calculated in figures \ref{fig:ExcessPEVR} and \ref{fig:ExcessPEFR} are equivalent to the upper bound for the formation energy discussed in Chapter \ref{ch:Intro}. The correlation between the potential energy in the triple lines and their adjoining grain boundaries can also be investigated using the Pearson correlation coefficient which provides a measure of the linear correlation between the two quanitites.

\begin{figure}[H]
	\includegraphics[scale=0.75]{images/ScatterTJvsGB.png} 
	\label{fig:ScatterTJvsGB}
	\caption{Scatter plot of mean potential energy per atom in the triple line of different radii against mean potential energy per atom in the adjoining grain boundaries.}
\end{figure}

The scatter plot in Figure \ref{fig:ScatterTJvsGB} shows a weak positive correlation between the potential energies per atom of the triple line and the adjoining grain boundaries as the Pearson correlation coefficient was $0.75$. There appears to be some points where the triple line potential energy per atom did not closely follow the trend shown in the rest of the data and in fact had a less negative value. 

The corresponding scatter plot for triple lines of fixed radii is shown in Figure \ref{fig:ScatterTJvsGBFR}. The correlation appears to be weaker, although still postive, with a Perason correlation coefficient of $0.58 < 0.75$. 

\begin{figure}
	\includegraphics[scale=0.75]{images/ScatterTJvsGBFR.png} 
	\label{fig:ScatterTJvsGBFR}
	\caption{Scatter plot of mean potential energy per atom in the triple line of fixed radii against mean potential energy per atom in the adjoining grain boundaries.}
\end{figure}

The data suggests that the majority of triple lines have a positive excess energy per atom compared to their adjoining grain boundaries. For the triple lines with different radii there was a weak positive correlation between the two variables. The correlation was much weaker when all triple lines were assumed to have a fixed radii of $4.05 \AA$ 

The potential energy stored per per unit volume in the triple lines is also of interest as this takes into account the atomic density of the grain boundaries and triple lines. The variable radii of triple lines is shown in Figure \ref{fig:PEPerVol}. There is one possible outlier showing a larger than expected radius of more than $6.5 \AA$. 




The graph of potential energy per volume with differing triple line radii

\begin{figure}
	\includegraphics[scale=0.75]{images/TJPEPerVolume.png} 
	\label{fig:PEPerVol}
\end{figure}
$\mu = -0.19, \sigma = 0.021$ confidence interval $[-0.23, -0.15]$

The corresponding graph for fixed radii

\includegraphics[scale=1]{images/TJPEPerVolumeFR.png} 

has ide
$\mu = -0.19, \sigma = 0.021$ confidence interval $[-0.23, -0.15]$

atomic density variable radii


\subsection{Triple Line Formation Energy}

The calculations based upon the simulation results do confirm that all the triple lines tested have a negative formation energy. The calculation was based upon the potential energies and does not include an entropic contribution. The process for calculating the theoretical formation energy of the triple line is based upon a mass balance and mean values of potential energies in the triple line, adjacent grain boundaries and the lattice.

The formation energy of the triple line is formally defined as the difference in energy of two systems with an identical number of atoms one which contains a triple line and three grain boundaries and the other contains three non-intersecting grain boundaries. The energy can be thought of the work done in changing from one system to the other.

The theoretical possibility of negative formation energies for defects were discussed in \cite{KIRCHHEIM20075129} and it was argued using free energy that this does not necessary lead to an perpetual increase in the number of defects if there are solute atoms.  

variable radii

\includegraphics[scale=0.75]{images/TjFormationEnergyVR.png} 

$\mu = -0.10, \sigma = 0.031$ $[-0.16,  -0.036]$


fixed radii

\includegraphics[scale=0.75]{images/TJFormationEnergyFR.png} 
$\mu = -0.090 , \sigma =  0.023 [-0.13, -0.043]$

\section{Lower Bound for Formation Energy}

Let $n_{TJ}$ be the number of triple line atoms and $U_{TJ}$ be the mean potential energy per atom. Furthermore if $U_{L}$ and $U_{GB}$ are the mean potential energies per atom for the lattice and grain boundary atoms the following expression defines the energy of formation of the triple line $E_{fl}$

\[ E_{fl} = n_{TJ}\left(U_{TJ} -3U_{GB} + 2U_{L} \right) \]

The term $U_{GB}$ is the averaged potential energy per atom where the summation is over all the atoms in the adjacent grain boundaries but excludes atoms defined to be in the triple line region. The equation is the natural analogue of the formation energy of the quad line given in Chapter \ref{ch:Intro}.



    

\section{Upper Bound for Formation Energy}

An upper bound for the formation energy for the triple line can be estimated by assuming that the only change in energy is that the  $n_{TJ}$ atoms formed in the triple line all come from the grain boundaries and there are is no increase in the number of lattice atoms. This means that there is no increase in the number of low energy lattice atoms. In general this will be a positive quantity as the triple line atoms are higher energy than the grain boundaries. 

However this formation energy definition includes the extension  


\chapter{Conclusion}

\section{Nucleating New Grains}

If the triple lines do have a negative excess energy compared with the grain boundaries then it is possible that there is a sufficiently strong driving force to subdivide triple lines into three and nucleate a new grain. In general there would be an energy barrier to this process and it is likely that it could only occur if the new created grain boundaries consisted of a low interfacial energy.

With the $[1,1,1]$ direction of each the lattice of each grain paralell to the $\mathbf{k}$ direction of the simulation cell this phenomenon was observed when grains 1 and 2 were rotated about $\mathbf{k}$  by an angle of 20 and 40 degrees respectively. The fact that the grain boundaries and triple lines changed significantly suggests that the initial configuration was unstable. 

However this was more than simply a reconfiguration of the existing grain boundaries and triple lines. A new grain was produced and more grain boundaries and triple lines were created. If all the grains were defect free then each would have an equal Gibbs free energy per unit volume. Grain boundaries always have an positive excess energy and so for this to be energetically favourable the triple lines should have a negative excess energy.

The pre-existing grains shown in the following image have clearly developed some defects and so the argument used in the previous paragraph is more complicated. It may still be possible that the driving force for the new grain could be accounted for by the difference in Gibbs free energy per unit volume between the grains with defects and a pristine new grain. If this were true it would this would not necessarily indicate that a triple line has a negative excess energy.

\begin{figure}
	\centering
	\includegraphics[scale=1.5]{images/NewGrains.png} 
	\label{fig:NewGrains}
	\caption{Ovito image after a thermal anneal and energy minimisation which may show the early nucleation of a new grain}
\end{figure}

The following image was taken from an $[1 1 0]$ image from folder $data1$ with angles 15 and 30 degrees.


\section{Future Work} \label{sec:FutureWork}


Many of the triple lines studied had a positive mean excess potential energy per atom compared to the mean potential energy per atom of the three adjacent grain boundaries. This suggests that a triple line could be a good candidate for nucleating new grains. If a new grain was formed at producing three lower energy triple lines and three low energy grain boundaries then this could achieve a reduction in the overall potential energy of the system.

Two adjacent triple lines with high potential energy joined by a high energy grain boundary may also merge by effectively removing the high energy grain boundary. 


The method so far has focussed on molecular dynamics which has essentially used classical mechanics to simulate the motion of atoms based upon a emperical potential. The entropy of the system has not been considered. The energy calculations have focussed on the potential energies of different regions in the system. Molecular systems actually minimise their free energy and not necessarily the potential energy 

A future examination of the triple lines will extend this approach using density function theory. This is a well established quantum mechanical approximation and the results can be compared to the classical simulations. In general it will not be possible to run DFT simulations with the same size of simulation cell.

\cite{HASHIBON2010939} details possible approach using Gibbs free energy and DFT at 0 Kelvin but also outlines the inherent difficulties of DFT with large simulation cells.

A new possible approach to finding the energy of the triple line based upon an approach outlined in \cite{Lee2004}

  
\bibliographystyle{unsrtnat}
\bibliography{FirstYearReport} 

\end{document}